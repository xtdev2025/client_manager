#!/bin/sh

echo "üîç Executando verifica√ß√µes de pr√©-commit..."

# Verificar arquivos .env
if git diff --cached --name-only | grep -q '\.env$'; then
  echo "‚ùå Arquivo .env detectado no commit. Remova antes de commitar."
  exit 1
fi

# Verificar arquivos Python
PYTHON_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep '\.py$' || true)

if [ -n "$PYTHON_FILES" ]; then
  echo "üìù Verificando c√≥digo Python..."
  if ! echo "$PYTHON_FILES" | xargs flake8 --count --select=E9,F63,F7,F82 --show-source --statistics; then
    echo "‚ùå Erros de c√≥digo encontrados."
    exit 1
  fi
fi

echo "‚úÖ Pr√©-commit passou!"