#!/bin/sh

echo "ğŸš€ Executando verificaÃ§Ãµes de prÃ©-push..."

# Verificar estilo de cÃ³digo com flake8
echo "ğŸ“ Verificando todo o cÃ³digo Python..."
flake8 . --count --select=E9,F63,F7,F82 --show-source --statistics

if [ $? -ne 0 ]; then
  echo "âŒ Problemas no cÃ³digo encontrados. Corrija antes de enviar."
  exit 1
fi

# Executar testes se existirem
if [ -f "pytest.ini" ] || [ -d "tests" ]; then
  echo "ğŸ§ª Executando testes..."
  python -m pytest tests/ -v --tb=short
  
  if [ $? -ne 0 ]; then
    echo "âŒ Testes falharam. Corrija antes de enviar."
    exit 1
  fi
fi

echo "âœ… PrÃ©-push passou com sucesso!"