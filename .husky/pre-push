#!/bin/sh

echo "🚀 Executando verificações de pré-push..."

# Verificar estilo de código com flake8
echo "📝 Verificando todo o código Python..."
flake8 . --count --select=E9,F63,F7,F82 --show-source --statistics

if [ $? -ne 0 ]; then
  echo "❌ Problemas no código encontrados. Corrija antes de enviar."
  exit 1
fi

# Executar testes se existirem
if [ -f "pytest.ini" ] || [ -d "tests" ]; then
  echo "🧪 Executando testes..."
  python -m pytest tests/ -v --tb=short
  
  if [ $? -ne 0 ]; then
    echo "❌ Testes falharam. Corrija antes de enviar."
    exit 1
  fi
fi

echo "✅ Pré-push passou com sucesso!"