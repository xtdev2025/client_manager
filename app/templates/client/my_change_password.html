{% extends "client_layout.html" %}

{% block title %}Trocar Senha - Client Manager{% endblock %}

{% block content %}
<div class="content-wrapper">
<!-- Page Header -->
<div class="row mb-4">
    <div class="col-12">
        <div class="d-flex justify-content-between align-items-center">
            <div>
                <h2 class="mb-1">
                    <i class="fas fa-key text-primary me-2"></i>Trocar Senha
                </h2>
                <p class="text-muted mb-0">Altere sua senha de acesso</p>
            </div>
        </div>
    </div>
</div>

<!-- Change Password Form -->
<div class="row">
    <div class="col-lg-6 col-md-8 mx-auto">
        <div class="card shadow-sm">
            <div class="card-body p-4">
                <form method="POST" action="{{ url_for('client_domain.change_password') }}">
                    <!-- Current Password -->
                    <div class="mb-4">
                        <label for="current_password" class="form-label">
                            <i class="fas fa-lock me-2"></i>Senha Atual
                        </label>
                        <input type="password" 
                               class="form-control form-control-lg" 
                               id="current_password" 
                               name="current_password" 
                               placeholder="Digite sua senha atual"
                               required>
                        <small class="form-text text-muted">
                            Digite sua senha atual para confirmar sua identidade
                        </small>
                    </div>

                    <hr class="my-4">

                    <!-- New Password -->
                    <div class="mb-3">
                        <label for="new_password" class="form-label">
                            <i class="fas fa-key me-2"></i>Nova Senha
                        </label>
                        <input type="password" 
                               class="form-control form-control-lg" 
                               id="new_password" 
                               name="new_password" 
                               placeholder="Digite sua nova senha"
                               minlength="6"
                               required>
                        <small class="form-text text-muted">
                            Mínimo de 6 caracteres
                        </small>
                    </div>

                    <!-- Confirm New Password -->
                    <div class="mb-4">
                        <label for="confirm_password" class="form-label">
                            <i class="fas fa-check-circle me-2"></i>Confirmar Nova Senha
                        </label>
                        <input type="password" 
                               class="form-control form-control-lg" 
                               id="confirm_password" 
                               name="confirm_password" 
                               placeholder="Confirme sua nova senha"
                               minlength="6"
                               required>
                        <small class="form-text text-muted">
                            Digite novamente a nova senha
                        </small>
                    </div>

                    <!-- Password Strength Indicator -->
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>
                        <strong>Dicas para uma senha segura:</strong>
                        <ul class="mb-0 mt-2">
                            <li>Use no mínimo 6 caracteres</li>
                            <li>Combine letras maiúsculas e minúsculas</li>
                            <li>Inclua números e caracteres especiais</li>
                            <li>Não use informações pessoais óbvias</li>
                        </ul>
                    </div>

                    <!-- Action Buttons -->
                    <div class="d-flex gap-2 mt-4">
                        <button type="submit" class="btn btn-primary btn-lg flex-grow-1">
                            <i class="fas fa-save me-2"></i>Alterar Senha
                        </button>
                        <a href="{{ url_for('main.dashboard') }}" class="btn btn-outline-secondary btn-lg">
                            <i class="fas fa-times me-2"></i>Cancelar
                        </a>
                    </div>
                </form>
            </div>
        </div>

        <!-- Security Info Card -->
        <div class="card shadow-sm mt-3">
            <div class="card-body">
                <h6 class="card-title">
                    <i class="fas fa-shield-alt text-success me-2"></i>Segurança da Conta
                </h6>
                <p class="card-text text-muted small mb-0">
                    Suas senhas são criptografadas e armazenadas com segurança. 
                    Recomendamos trocar sua senha periodicamente para manter sua conta protegida.
                </p>
            </div>
        </div>
    </div>
</div>
</div>

<script>
// Password match validation
document.addEventListener('DOMContentLoaded', function() {
    const newPassword = document.getElementById('new_password');
    const confirmPassword = document.getElementById('confirm_password');
    
    function validatePasswordMatch() {
        if (confirmPassword.value && newPassword.value !== confirmPassword.value) {
            confirmPassword.setCustomValidity('As senhas não coincidem');
            confirmPassword.classList.add('is-invalid');
        } else {
            confirmPassword.setCustomValidity('');
            confirmPassword.classList.remove('is-invalid');
            if (confirmPassword.value) {
                confirmPassword.classList.add('is-valid');
            }
        }
    }
    
    newPassword.addEventListener('input', validatePasswordMatch);
    confirmPassword.addEventListener('input', validatePasswordMatch);
});
</script>
{% endblock %}
